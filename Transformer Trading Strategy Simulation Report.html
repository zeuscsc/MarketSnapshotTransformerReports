<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trading Strategy Simulation Results</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
font-family: 'Inter', sans-serif;
background-color: #f8f9fa;
}
.chart-container {
position: relative;
width: 100%;
max-width: 800px;
margin-left: auto;
margin-right: auto;
height: 400px;
max-height: 50vh;
}
@media (max-width: 768px) {
.chart-container {
height: 300px;
max-height: 60vh;
}
}
</style>
</head>
<body class="text-[#001219]">

<main class="container mx-auto p-4 md:p-8">

    <header class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-bold text-[#005f73] mb-2">Trading Strategy Simulation Report</h1>
        <p class="text-lg text-gray-600">An analysis of performance across 120 tickers in the test set.</p>
    </header>

    <section class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8 mb-12 text-center">
        <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold text-[#005f73] mb-2">Overall Portfolio Return</h3>
            <p class="text-4xl font-bold text-[#0a9396]">1.49%</p>
        </div>
        <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold text-[#005f73] mb-2">Total Portfolio Profit</h3>
            <p class="text-4xl font-bold text-[#0a9396]">$17,844.56</p>
        </div>
        <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold text-[#005f73] mb-2">Average Ticker Return</h3>
            <p class="text-4xl font-bold text-[#0a9396]">$148.70</p>
        </div>
    </section>

    <section class="grid grid-cols-1 lg:grid-cols-5 gap-6 md:gap-8 mb-12">
        <div class="lg:col-span-2 bg-white rounded-lg shadow-md p-6">
            <h3 class="text-xl font-semibold text-[#005f73] mb-2 text-center">Ticker Performance Distribution</h3>
            <p class="text-gray-600 mb-4 text-center">This chart illustrates the proportion of tickers that yielded a positive return versus those that resulted in a loss during the simulation. It provides a high-level view of the strategy's overall success rate across the entire ticker set.</p>
            <div class="chart-container h-64 md:h-auto">
                <canvas id="performanceDistributionChart"></canvas>
            </div>
        </div>

        <div class="lg:col-span-3 bg-white rounded-lg shadow-md p-6">
            <h3 class="text-xl font-semibold text-[#005f73] mb-2 text-center">Risk vs. Return Analysis</h3>
             <p class="text-gray-600 mb-4 text-center">This scatter plot visualizes the relationship between the percentage return and the maximum drawdown for each ticker. It helps in assessing the risk-reward profile of the strategy, showing how much risk (drawdown) was taken to achieve a certain return.</p>
            <div class="chart-container" id="riskReturnScatterPlot"></div>
        </div>
    </section>

    <section class="bg-white rounded-lg shadow-md p-6 mb-12">
        <h3 class="text-2xl font-bold text-center text-[#005f73] mb-2">Top 10 Performing Tickers</h3>
        <p class="text-gray-600 mb-6 text-center">The following tickers demonstrated the highest percentage returns, leading the portfolio's gains. ASTS was the standout performer with an impressive 18.27% return.</p>
        <div class="chart-container h-96">
            <canvas id="topPerformersChart"></canvas>
        </div>
    </section>

    <section class="bg-white rounded-lg shadow-md p-6 mb-12">
        <h3 class="text-2xl font-bold text-center text-[#005f73] mb-2">Worst 10 Performing Tickers</h3>
        <p class="text-gray-600 mb-6 text-center">Conversely, these tickers had the most significant negative returns, highlighting areas where the strategy underperformed. The losses were generally contained, with the largest loss being -3.86% for LEN.</p>
        <div class="chart-container h-96">
            <canvas id="worstPerformersChart"></canvas>
        </div>
    </section>

    <section class="bg-white rounded-lg shadow-md p-6 mb-12">
         <h3 class="text-2xl font-bold text-center text-[#005f73] mb-2">Trading Activity vs. Performance</h3>
         <p class="text-gray-600 mb-6 text-center">This bubble chart explores the relationship between the number of trades executed, the percentage return, and the absolute profit amount (represented by bubble size). This helps identify if trading frequency correlates with profitability or risk.</p>
        <div class="chart-container">
            <canvas id="tradesVsReturnBubbleChart"></canvas>
        </div>
    </section>

</main>

<footer class="text-center p-6 mt-8">
    <p class="text-gray-500">This report was automatically generated based on test set simulation data. Past performance is not indicative of future results.</p>
</footer>

<script>
    const fullData = [
        { ticker: 'ASTS', return_pct: 18.27, profit: 1827.09, max_drawdown_pct: -5.23, num_trades: 59 },
        { ticker: 'CMG', return_pct: 16.67, profit: 1667.03, max_drawdown_pct: -3.79, num_trades: 49 },
        { ticker: 'CORT', return_pct: 15.29, profit: 1528.87, max_drawdown_pct: -3.80, num_trades: 48 },
        { ticker: 'HIMS', return_pct: 10.51, profit: 1051.27, max_drawdown_pct: -8.48, num_trades: 43 },
        { ticker: 'ADMA', return_pct: 7.04, profit: 704.36, max_drawdown_pct: -3.27, num_trades: 52 },
        { ticker: 'CRWD', return_pct: 6.74, profit: 673.97, max_drawdown_pct: -3.91, num_trades: 65 },
        { ticker: 'EAT', return_pct: 6.69, profit: 669.40, max_drawdown_pct: -2.90, num_trades: 53 },
        { ticker: 'EXEL', return_pct: 5.99, profit: 599.00, max_drawdown_pct: -1.42, num_trades: 72 },
        { ticker: 'APH', return_pct: 5.89, profit: 588.97, max_drawdown_pct: -2.19, num_trades: 82 },
        { ticker: 'LBRDA', return_pct: 5.64, profit: 564.42, max_drawdown_pct: -2.67, num_trades: 70 },
        { ticker: 'EQT', return_pct: 5.49, profit: 548.56, max_drawdown_pct: -2.02, num_trades: 68 },
        { ticker: 'FTAI', return_pct: 5.44, profit: 543.70, max_drawdown_pct: -6.69, num_trades: 61 },
        { ticker: 'AER', return_pct: 5.17, profit: 517.10, max_drawdown_pct: -1.98, num_trades: 105 },
        { ticker: 'CQP', return_pct: 4.95, profit: 495.24, max_drawdown_pct: -1.94, num_trades: 87 },
        { ticker: 'KLAC', return_pct: 4.94, profit: 494.10, max_drawdown_pct: -2.62, num_trades: 81 },
        { ticker: 'INTC', return_pct: 4.85, profit: 485.05, max_drawdown_pct: -3.50, num_trades: 63 },
        { ticker: 'KNSL', return_pct: 4.79, profit: 478.78, max_drawdown_pct: -2.54, num_trades: 79 },
        { ticker: 'FTNT', return_pct: 4.69, profit: 468.92, max_drawdown_pct: -3.40, num_trades: 93 },
        { ticker: 'MSTR', return_pct: 4.31, profit: 430.98, max_drawdown_pct: -4.95, num_trades: 41 },
        { ticker: 'INSM', return_pct: 4.29, profit: 429.37, max_drawdown_pct: -2.68, num_trades: 80 },
        { ticker: 'AR', return_pct: 3.87, profit: 386.57, max_drawdown_pct: -2.67, num_trades: 60 },
        { ticker: 'BA', return_pct: 3.81, profit: 380.84, max_drawdown_pct: -3.29, num_trades: 63 },
        { ticker: 'MRVL', return_pct: 3.73, profit: 373.19, max_drawdown_pct: -11.07, num_trades: 65 },
        { ticker: 'GOOG', return_pct: 3.51, profit: 350.91, max_drawdown_pct: -3.77, num_trades: 93 },
        { ticker: 'CDNS', return_pct: 3.34, profit: 333.74, max_drawdown_pct: -3.16, num_trades: 75 },
        { ticker: 'CVNA', return_pct: 3.28, profit: 328.19, max_drawdown_pct: -6.25, num_trades: 32 },
        { ticker: 'ISRG', return_pct: 3.26, profit: 326.45, max_drawdown_pct: -3.16, num_trades: 104 },
        { ticker: 'CHTR', return_pct: 3.20, profit: 319.74, max_drawdown_pct: -1.75, num_trades: 84 },
        { ticker: 'PANW', return_pct: 3.12, profit: 311.99, max_drawdown_pct: -3.22, num_trades: 72 },
        { ticker: 'BMY', return_pct: 3.00, profit: 300.17, max_drawdown_pct: -4.41, num_trades: 92 },
        { ticker: 'MU', return_pct: 2.94, profit: 293.55, max_drawdown_pct: -4.99, num_trades: 58 },
        { ticker: 'NFLX', return_pct: 2.86, profit: 285.87, max_drawdown_pct: -1.70, num_trades: 70 },
        { ticker: 'MSFT', return_pct: 2.86, profit: 285.76, max_drawdown_pct: -2.25, num_trades: 82 },
        { ticker: 'AM', return_pct: 2.85, profit: 284.92, max_drawdown_pct: -1.82, num_trades: 100 },
        { ticker: 'NVDA', return_pct: 2.78, profit: 277.76, max_drawdown_pct: -4.60, num_trades: 61 },
        { ticker: 'LNTH', return_pct: 2.54, profit: 254.49, max_drawdown_pct: -5.05, num_trades: 77 },
        { ticker: 'ORLY', return_pct: 2.53, profit: 252.95, max_drawdown_pct: -1.07, num_trades: 116 },
        { ticker: 'AXS', return_pct: 2.45, profit: 245.01, max_drawdown_pct: -1.47, num_trades: 103 },
        { ticker: 'GS', return_pct: 2.02, profit: 201.89, max_drawdown_pct: -2.62, num_trades: 80 },
        { ticker: 'COST', return_pct: 1.96, profit: 196.32, max_drawdown_pct: -1.72, num_trades: 97 },
        { ticker: 'AMZN', return_pct: 1.95, profit: 195.15, max_drawdown_pct: -4.50, num_trades: 81 },
        { ticker: 'BSX', return_pct: 1.93, profit: 193.06, max_drawdown_pct: -2.40, num_trades: 106 },
        { ticker: 'AJG', return_pct: 1.89, profit: 188.81, max_drawdown_pct: -1.56, num_trades: 105 },
        { ticker: 'GILD', return_pct: 1.87, profit: 186.88, max_drawdown_pct: -2.11, num_trades: 93 },
        { ticker: 'IBKR', return_pct: 1.87, profit: 186.68, max_drawdown_pct: -5.74, num_trades: 58 },
        { ticker: 'CBOE', return_pct: 1.86, profit: 185.60, max_drawdown_pct: -1.67, num_trades: 105 },
        { ticker: 'COR', return_pct: 1.84, profit: 184.25, max_drawdown_pct: -1.53, num_trades: 102 },
        { ticker: 'ADSK', return_pct: 1.82, profit: 181.56, max_drawdown_pct: -2.85, num_trades: 82 },
        { ticker: 'MPLX', return_pct: 1.80, profit: 180.38, max_drawdown_pct: -1.93, num_trades: 106 },
        { ticker: 'HON', return_pct: 1.75, profit: 174.77, max_drawdown_pct: -2.69, num_trades: 79 },
        { ticker: 'DE', return_pct: 1.53, profit: 152.58, max_drawdown_pct: -2.25, num_trades: 76 },
        { ticker: 'ET', return_pct: 1.43, profit: 143.18, max_drawdown_pct: -3.71, num_trades: 120 },
        { ticker: 'CSCO', return_pct: 1.27, profit: 126.64, max_drawdown_pct: -2.81, num_trades: 106 },
        { ticker: 'HCA', return_pct: 1.18, profit: 118.46, max_drawdown_pct: -4.22, num_trades: 90 },
        { ticker: 'AVGO', return_pct: 1.11, profit: 111.16, max_drawdown_pct: -6.11, num_trades: 62 },
        { ticker: 'CB', return_pct: 1.10, profit: 110.46, max_drawdown_pct: -2.38, num_trades: 101 },
        { ticker: 'ABBV', return_pct: 1.08, profit: 107.85, max_drawdown_pct: -2.84, num_trades: 70 },
        { ticker: 'MO', return_pct: 1.06, profit: 105.76, max_drawdown_pct: -2.17, num_trades: 99 },
        { ticker: 'JPM', return_pct: 1.00, profit: 99.64, max_drawdown_pct: -3.65, num_trades: 73 },
        { ticker: 'MPWR', return_pct: 0.95, profit: 95.42, max_drawdown_pct: -4.50, num_trades: 78 },
        { ticker: 'MPC', return_pct: 0.90, profit: 90.21, max_drawdown_pct: -3.18, num_trades: 75 },
        { ticker: 'ORCL', return_pct: 0.90, profit: 90.12, max_drawdown_pct: -5.11, num_trades: 65 },
        { ticker: 'CNC', return_pct: 0.88, profit: 88.49, max_drawdown_pct: -4.23, num_trades: 90 },
        { ticker: 'CTRA', return_pct: 0.76, profit: 75.72, max_drawdown_pct: -2.68, num_trades: 66 },
        { ticker: 'APO', return_pct: 0.65, profit: 64.66, max_drawdown_pct: -4.70, num_trades: 63 },
        { ticker: 'F', return_pct: 0.63, profit: 63.41, max_drawdown_pct: -3.57, num_trades: 87 },
        { ticker: 'GLD', return_pct: 0.51, profit: 51.45, max_drawdown_pct: -1.21, num_trades: 127 },
        { ticker: 'IBM', return_pct: 0.43, profit: 43.03, max_drawdown_pct: -2.04, num_trades: 76 },
        { ticker: 'BLK', return_pct: 0.42, profit: 41.68, max_drawdown_pct: -2.50, num_trades: 94 },
        { ticker: 'DINO', return_pct: 0.38, profit: 38.16, max_drawdown_pct: -4.40, num_trades: 76 },
        { ticker: 'ETN', return_pct: 0.35, profit: 35.44, max_drawdown_pct: -3.56, num_trades: 70 },
        { ticker: 'HES', return_pct: 0.33, profit: 33.44, max_drawdown_pct: -2.50, num_trades: 94 },
        { ticker: 'MS', return_pct: 0.30, profit: 29.63, max_drawdown_pct: -4.42, num_trades: 68 },
        { ticker: 'MTG', return_pct: 0.15, profit: 15.03, max_drawdown_pct: -2.49, num_trades: 96 },
        { ticker: 'DELL', return_pct: 0.15, profit: 14.53, max_drawdown_pct: -6.02, num_trades: 51 },
        { ticker: 'ANET', return_pct: 0.09, profit: 8.63, max_drawdown_pct: -7.83, num_trades: 68 },
        { ticker: 'MMC', return_pct: 0.03, profit: 2.81, max_drawdown_pct: -1.69, num_trades: 109 },
        { ticker: 'MELI', return_pct: 0.00, profit: 0.00, max_drawdown_pct: 0.00, num_trades: 0 },
        { ticker: 'BRK', return_pct: 0.00, profit: 0.00, max_drawdown_pct: 0.00, num_trades: 0 },
        { ticker: 'BKNG', return_pct: 0.00, profit: 0.00, max_drawdown_pct: 0.00, num_trades: 0 },
        { ticker: 'CG', return_pct: -0.03, profit: -2.72, max_drawdown_pct: -5.25, num_trades: 62 },
        { ticker: 'META', return_pct: -0.03, profit: -2.78, max_drawdown_pct: -4.82, num_trades: 60 },
        { ticker: 'MCK', return_pct: -0.14, profit: -13.90, max_drawdown_pct: -1.70, num_trades: 111 },
        { ticker: 'BAC', return_pct: -0.34, profit: -34.30, max_drawdown_pct: -4.15, num_trades: 88 },
        { ticker: 'AXP', return_pct: -0.41, profit: -40.66, max_drawdown_pct: -4.25, num_trades: 85 },
        { ticker: 'EG', return_pct: -0.45, profit: -44.96, max_drawdown_pct: -2.49, num_trades: 87 },
        { ticker: 'OVV', return_pct: -0.53, profit: -53.15, max_drawdown_pct: -4.86, num_trades: 65 },
        { ticker: 'DIS', return_pct: -0.56, profit: -55.75, max_drawdown_pct: -4.45, num_trades: 80 },
        { ticker: 'KO', return_pct: -0.61, profit: -60.66, max_drawdown_pct: -2.36, num_trades: 94 },
        { ticker: 'NEE', return_pct: -0.71, profit: -71.15, max_drawdown_pct: -3.44, num_trades: 86 },
        { ticker: 'COP', return_pct: -0.91, profit: -91.23, max_drawdown_pct: -3.55, num_trades: 81 },
        { ticker: 'NKE', return_pct: -0.94, profit: -93.73, max_drawdown_pct: -5.07, num_trades: 77 },
        { ticker: 'MSI', return_pct: -0.96, profit: -95.59, max_drawdown_pct: -3.12, num_trades: 109 },
        { ticker: 'ESNT', return_pct: -1.04, profit: -103.78, max_drawdown_pct: -2.79, num_trades: 85 },
        { ticker: 'ACGL', return_pct: -1.13, profit: -112.54, max_drawdown_pct: -3.95, num_trades: 99 },
        { ticker: 'ARCC', return_pct: -1.13, profit: -112.83, max_drawdown_pct: -3.49, num_trades: 127 },
        { ticker: 'ACN', return_pct: -1.15, profit: -115.16, max_drawdown_pct: -4.38, num_trades: 80 },
        { ticker: 'CF', return_pct: -1.21, profit: -120.58, max_drawdown_pct: -4.12, num_trades: 70 },
        { ticker: 'EOG', return_pct: -1.31, profit: -130.83, max_drawdown_pct: -3.54, num_trades: 72 },
        { ticker: 'NOW', return_pct: -1.35, profit: -135.22, max_drawdown_pct: -3.26, num_trades: 60 },
        { ticker: 'EWBC', return_pct: -1.54, profit: -154.41, max_drawdown_pct: -5.22, num_trades: 55 },
        { ticker: 'EPD', return_pct: -1.73, profit: -172.56, max_drawdown_pct: -2.75, num_trades: 100 },
        { ticker: 'MKTX', return_pct: -1.80, profit: -180.26, max_drawdown_pct: -5.61, num_trades: 71 },
        { ticker: 'PAA', return_pct: -1.96, profit: -196.47, max_drawdown_pct: -3.21, num_trades: 91 },
        { ticker: 'OKE', return_pct: -2.00, profit: -199.74, max_drawdown_pct: -3.88, num_trades: 85 },
        { ticker: 'CVX', return_pct: -2.01, profit: -201.17, max_drawdown_pct: -3.45, num_trades: 95 },
        { ticker: 'CAT', return_pct: -2.08, profit: -207.98, max_drawdown_pct: -4.96, num_trades: 55 },
        { ticker: 'JNJ', return_pct: -2.32, profit: -231.97, max_drawdown_pct: -3.03, num_trades: 80 },
        { ticker: 'KKR', return_pct: -2.37, profit: -236.68, max_drawdown_pct: -6.80, num_trades: 56 },
        { ticker: 'INTU', return_pct: -2.42, profit: -241.55, max_drawdown_pct: -6.81, num_trades: 55 },
        { ticker: 'DHI', return_pct: -2.48, profit: -248.04, max_drawdown_pct: -4.25, num_trades: 79 },
        { ticker: 'ELV', return_pct: -2.73, profit: -273.50, max_drawdown_pct: -4.78, num_trades: 79 },
        { ticker: 'ADBE', return_pct: -2.77, profit: -277.15, max_drawdown_pct: -4.28, num_trades: 76 },
        { ticker: 'AMGN', return_pct: -2.85, profit: -285.17, max_drawdown_pct: -3.85, num_trades: 79 },
        { ticker: 'DVN', return_pct: -3.23, profit: -322.62, max_drawdown_pct: -5.54, num_trades: 67 },
        { ticker: 'APA', return_pct: -3.27, profit: -327.49, max_drawdown_pct: -7.28, num_trades: 65 },
        { ticker: 'DHR', return_pct: -3.52, profit: -352.20, max_drawdown_pct: -5.37, num_trades: 97 },
        { ticker: 'BX', return_pct: -3.68, profit: -367.65, max_drawdown_pct: -6.07, num_trades: 57 },
        { ticker: 'PEP', return_pct: -3.72, profit: -372.35, max_drawdown_pct: -3.96, num_trades: 79 },
        { ticker: 'LEN', return_pct: -3.86, profit: -386.20, max_drawdown_pct: -4.90, num_trades: 83 },
    ];

    const colors = {
        primary: '#005f73',
        secondary: '#0a9396',
        accent: '#94d2bd',
        highlight: '#e9d8a6',
        danger: '#ae2012',
        text: '#001219'
    };

    function wrapLabel(label, maxWidth) {
        if (label.length <= maxWidth) {
            return label;
        }
        const words = label.split(' ');
        const lines = [];
        let currentLine = '';
        for (const word of words) {
            if ((currentLine + ' ' + word).trim().length > maxWidth && currentLine.length > 0) {
                lines.push(currentLine);
                currentLine = word;
            } else {
                currentLine = (currentLine + ' ' + word).trim();
            }
        }
        if (currentLine.length > 0) {
            lines.push(currentLine);
        }
        return lines;
    }

    const chartTooltipTitleCallback = {
        plugins: {
            tooltip: {
                callbacks: {
                    title: function(tooltipItems) {
                        const item = tooltipItems[0];
                        let label = item.chart.data.labels[item.dataIndex];
                        if (Array.isArray(label)) {
                            return label.join(' ');
                        } else {
                            return label;
                        }
                    }
                }
            }
        }
    };

    const top10 = fullData.slice(0, 50);
    const worst10 = fullData.slice(-50).sort((a,b) => a.return_pct - b.return_pct);

    new Chart(document.getElementById('topPerformersChart'), {
        type: 'bar',
        data: {
            labels: top10.map(d => d.ticker),
            datasets: [{
                label: 'Return %',
                data: top10.map(d => d.return_pct),
                backgroundColor: colors.secondary,
                borderColor: colors.primary,
                borderWidth: 1
            }]
        },
        options: {
            ...chartTooltipTitleCallback,
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    beginAtZero: true,
                    title: { display: true, text: 'Return %' }
                }
            },
            plugins: {
                ...chartTooltipTitleCallback.plugins,
                legend: { display: false }
            }
        }
    });

    new Chart(document.getElementById('worstPerformersChart'), {
        type: 'bar',
        data: {
            labels: worst10.map(d => d.ticker),
            datasets: [{
                label: 'Return %',
                data: worst10.map(d => d.return_pct),
                backgroundColor: colors.danger,
                borderColor: '#6a040f',
                borderWidth: 1
            }]
        },
        options: {
            ...chartTooltipTitleCallback,
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    title: { display: true, text: 'Return %' }
                }
            },
            plugins: {
                ...chartTooltipTitleCallback.plugins,
                legend: { display: false }
            }
        }
    });

    const profitableCount = fullData.filter(d => d.profit > 0).length;
    const unprofitableCount = fullData.filter(d => d.profit <= 0).length;
    new Chart(document.getElementById('performanceDistributionChart'), {
        type: 'doughnut',
        data: {
            labels: ['Profitable Tickers', 'Unprofitable Tickers'],
            datasets: [{
                data: [profitableCount, unprofitableCount],
                backgroundColor: [colors.secondary, colors.danger],
                hoverOffset: 4
            }]
        },
        options: {
            ...chartTooltipTitleCallback,
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                ...chartTooltipTitleCallback.plugins,
                legend: {
                    position: 'bottom',
                }
            }
        }
    });

    const scatterData = {
        x: fullData.map(d => Math.abs(d.max_drawdown_pct)),
        y: fullData.map(d => d.return_pct),
        mode: 'markers',
        type: 'scatter',
        text: fullData.map(d => d.ticker),
        marker: {
            size: 8,
            color: fullData.map(d => d.return_pct > 0 ? colors.secondary : colors.danger),
            opacity: 0.7
        }
    };

    const scatterLayout = {
        xaxis: {
            title: 'Maximum Drawdown % (Risk)',
            autorange: 'reversed'
        },
        yaxis: {
            title: 'Return % (Reward)'
        },
        hovermode: 'closest',
        margin: { l: 50, r: 20, b: 50, t: 20 },
        paper_bgcolor: 'rgba(0,0,0,0)',
        plot_bgcolor: 'rgba(0,0,0,0)',
    };

    Plotly.newPlot('riskReturnScatterPlot', [scatterData], scatterLayout, {responsive: true});
    
    const bubbleData = {
        datasets: [{
            label: 'Tickers',
            data: fullData.map(d => ({
                x: d.num_trades,
                y: d.return_pct,
                r: Math.sqrt(Math.abs(d.profit)) * 1.5,
                ticker: d.ticker,
                profit: d.profit
            })),
            backgroundColor: fullData.map(d => d.return_pct > 0 ? `${colors.secondary}B3` : `${colors.danger}B3`)
        }]
    };

    new Chart(document.getElementById('tradesVsReturnBubbleChart'), {
        type: 'bubble',
        data: bubbleData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    title: { display: true, text: 'Number of Trades' }
                },
                y: {
                    title: { display: true, text: 'Return %' }
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            const d = context.raw;
                            return `${d.ticker}: ${d.y.toFixed(2)}% Return, ${d.x} Trades, Profit: $${d.profit.toFixed(2)}`;
                        }
                    }
                },
                legend: { display: false }
            }
        }
    });
</script>

</body>
</html>